<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8" />
<title>Perfect Center</title>

<style>
    @font-face {
        font-family: "H";
        src: url("./H.ttf") format("truetype-variations"),
             url("./H.ttf") format("truetype");
        font-weight: 100 900;
        font-style: normal;
    }
    body {
        font-family: "H";
        padding: 20px;
        background: #ddd;
        direction: rtl;
    }
    #textInput {
        width: 100%;
        font-size: 22px;
        padding: 10px;
        direction: rtl;
        font-family: "H";
    }
</style>
</head>

<body>

<input id="textInput" placeholder="متن فارسی…" />

<button onclick="makePNG()">دانلود PNG وسط‌چین واقعی</button>

<canvas id="canvas" width="1024" height="1024" style="display:none;"></canvas>

<script>
function makePNG() {
    const canvas = document.getElementById("canvas");
    const ctx = canvas.getContext("2d");

    const text = document.getElementById("textInput").value || "متن وسط";

    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // تنظیمات بولد
    ctx.font = '192px "H"';
    ctx.fontVariationSettings = '"wght" 520';
    ctx.fillStyle = "black";
    ctx.textBaseline = "middle";

    // اندازه‌گیری واقعی
    const m = ctx.measureText(text);

    const realWidth = m.actualBoundingBoxLeft + m.actualBoundingBoxRight;

    const x = (canvas.width / 2) - (realWidth / 2) + m.actualBoundingBoxLeft;
    const y = canvas.height / 2;

    ctx.fillText(text, x, y);

    const link = document.createElement("a");
    link.download = "perfect_center.png";
    link.href = canvas.toDataURL("image/png");
    link.click();
}
</script>

</body>
</html>
